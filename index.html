<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0"/>
        <link rel="icon" type="image/png" sizes="32x32" href="https://www.codency.uno/assets/images/favicon-64x64.png">
        <title>Dashboard - Codency</title>
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <script src="https://cdn.tailwindcss.com"></script>        
        <style>
        html, body {
            height: 100%;
            margin: 0;
        }
        </style>
    </head>

    <body class="font-['Montserrat'] min-h-screen bg-[#FAFAF5] dark:bg-gray-900">

        <div class="flex h-screen overflow-hidden bg-transparent">
                        <!-- Sidebar -->
                        <div class="w-15 md:w-15 lg:w-40 bg-white dark:bg-gray-800 shadow-lg rounded md:rounded-lg lg:rounded-xl ml-2 mt-2 mb-2 md:ml-4 md:mt-4 md:mb-4 lg:ml-6 lg:mt-4 lg:mb-6 overflow-hidden" >
                            <div class="p-4 hidden lg:flex justify-center items-center">
                                <img src="https://www.codency.uno/assets/app-images/logo-colored.png" alt="Codency Logo" class="w-24 mb-4 rounded-full">
                            </div>        
                        <nav class="mt-4">
                        <a href="#home" class="nav-link flex items-center justify-start p-4 mx-2 rounded-full text-gray-700 dark:text-gray-200">
                            <svg class="w-6 h-6 lg:mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"/>
                            </svg>
                            <span class="hidden lg:inline text-sm">Dashboard</span>
                        </a>
                        <a href="#inventory" class="nav-link flex items-center justify-start p-4 mx-2 rounded-full text-gray-700 dark:text-gray-200">
                            <svg class="w-6 h-6 lg:mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
                            </svg>
                            <span class="hidden lg:inline text-sm">Portfolio</span>
                        </a>

                        <a href="#notifications" class="nav-link flex items-center justify-start p-4 mx-2 rounded-full text-gray-700 dark:text-gray-200">
                            <svg class="w-6 h-6 lg:mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                            </svg>
                            <span class="hidden lg:inline text-sm">Inbox</span>
                        </a>                        
                        
                        <a href="#marketing" class="nav-link flex items-center justify-start p-4 mx-2 rounded-full text-gray-700 dark:text-gray-200">
                            <svg class="w-6 h-6 lg:mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"/>
                            </svg>
                            <span class="hidden lg:inline text-sm">Marketing</span>
                        </a>

                        <a href="#profile" class="nav-link flex items-center justify-start p-4 mx-2 rounded-full text-gray-700 dark:text-gray-200">
                            <svg class="w-6 h-6 lg:mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                            <span class="hidden lg:inline text-sm">Profile</span>
                        </a>
                        </nav>  
                        <div class="fixed bottom-2 left-1 md:left-3 lg:left-5 pl-1 pb-4 w-full ml-1">
                            <!-- support -->                            
                            <button class="flex items-center justify-start pl-0 p-4 pb-0 mx-2 rounded-full text-gray-700 dark:text-gray-200 w-full">
                                <video class="w-14 h-14 mr-0" autoplay loop muted playsinline>
                                    <source src="https://www.codency.uno/assets/app-images/support.webm" type="video/webm">
                                </video>
                                <span class="hidden lg:inline text-sm">Support</span>
                            </button>                                                        
                            <button class="flex items-center justify-start pt-2 p-4 mx-2 rounded-full text-red-500 dark:text-red-500 w-full">
                                <svg class="w-6 h-6 lg:mr-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"/>
                                </svg>
                                <span class="hidden lg:inline text-sm">Logout</span>
                            </button>                            
                        </div>
                        </div>
                        <!-- Sidebar Script-->
                        <script>
                            document.addEventListener('DOMContentLoaded', function () {
                                const navLinks = document.querySelectorAll('.nav-link');
                                const sections = document.querySelectorAll('.section'); // More specific

                                // Hide all sections initially
                                sections.forEach(section => {
                                    section.classList.add('hidden');
                                });

                                // Show home section by default
                                document.getElementById('home').classList.remove('hidden');
                                document.querySelector('a[href="#home"]').classList.add('bg-[#F9D43A]');

                                navLinks.forEach(link => {
                                    link.addEventListener('click', function (e) {
                                        e.preventDefault();
                                        const targetId = this.getAttribute('href').substring(1);

                                        // Hide all sections
                                        sections.forEach(section => {
                                            section.classList.add('hidden');
                                        });

                                        // Show target section
                                        const targetSection = document.getElementById(targetId);
                                        if (targetSection) {
                                            targetSection.classList.remove('hidden');
                                        }

                                        // Update active nav link state
                                        navLinks.forEach(navLink => {
                                            navLink.classList.remove('bg-[#F9D43A]');
                                        });
                                        this.classList.add('bg-[#F9D43A]');
                                    });
                                });
                            });
                        </script>
    
                    
                        <!-- Main Content -->
                        <div class="flex-1 flex flex-col p-2 md:p-4 lg:p-4">

                            <!-- Home Section -->
                            <div id="home" class="section flex flex-col flex-1 bg-white rounded md:rounded-md lg:rounded-lg p-2 md:p-2 lg:p-3 overflow-y-auto mb-0 md:mb-2 lg:mb-4">
                                
                                    <div class="bg-white dark:bg-gray-800 rounded md:rounded-md lg:rounded-lg pt-1 md:pt-1 lg:pt-2 p-2 md:p-2 lg:p-3 mb-1 md:mb-2 lg:mb-3 shadow-md">
                                            <div class="flex items-center gap-4">
                                                <div>
                                                    <h2 class="text-sm md:text-base lg:text-lg font-bold mb-1 dark:text-white">Welcome!</h2>
                                                    <p class="text-xs md:text-sm lg:text-sm text-gray-600 dark:text-gray-300" id="inventorySlots"></p>
                                                    <button id="upgradeBtn" class="mt-1 bg-[#F9D43A] hover:bg-[#F9D43A]/80 text-xs md:text-sm lg:text-sm text-gray-50 px-1 md:px-2 lg:px-2 py-1 rounded">Upgrade</button>
                                                </div>
                                                <video autoplay loop muted playsinline class="w-16 h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 rounded-lg">
                                                    <source src="https://www.codency.uno/assets/app-images/cart-animation.webm" type="video/webm">
                                                </video>
                                            </div>
                                            <!-- Text and Upgrade btn Logic -->
                                            <script>
                                                function updateInventoryInfo() {
                                                const tier = localStorage.getItem('tier') || '1';
                                                const slots = {
                                                    '1': 0,
                                                    '2': 2,
                                                    '3': 4,
                                                    '4': 6,
                                                    '5': 8
                                                };
                                            
                                                const slotsText = document.getElementById('inventorySlots');
                                                const upgradeBtn = document.getElementById('upgradeBtn');
                                            
                                                slotsText.textContent = `Your account has ${slots[tier]} inventory slots`;
                                            
                                                if (tier === '5') {
                                                    upgradeBtn.classList.add('hidden');
                                                } else {
                                                    upgradeBtn.classList.remove('hidden');
                                                }
                                                }
                                            
                                                document.addEventListener('DOMContentLoaded', () => {
                                                    updateInventoryInfo();
                                                    setInterval(updateInventoryInfo, 2000);
                                                });
                                            </script>            
                                    </div>
                                    <!-- Stats Cards -->
                                    <div class="grid grid-cols-2 lg:grid-cols-4 md:grid-cols-4 gap-1 md:gap-2 lg:gap-3">
                                        <!-- Balance Card -->
                                         
                                        <div class="bg-white dark:bg-gray-800 rounded md:rounded-md lg:rounded-lg p-2 pl-2 md:pl-2 lg:pl-3 shadow-md">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <p class="text-xs md:text-base lg:text-base font-semibold text-gray-500 dark:text-gray-400">Wallet</p>
                                                    <h3 class="text-lg md:text-2xl lg:text-3xl font-bold dark:text-white" id="balanceDisplay">...</h3>
                                                </div>
                                                <svg class="hidden md:block w-8 h-8 text-[#F9D43A]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6a2 2 0 012-2h14a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V6zm2-2v2h14V4H5zm0 4v10h14V8H5zm4 3h6m-6 3h6"></path>
                                                </svg>
                                            </div>
                                        </div>

                                        <!-- Total Profits Card -->
                                        <div class="bg-white dark:bg-gray-800 rounded md:rounded-md lg:rounded-lg p-2 pl-2 md:pl-2 lg:pl-3 shadow-md">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <p class="text-xs md:text-base lg:text-base font-semibold text-gray-500 dark:text-gray-400">Net Gains</p>
                                                    <h3 class="text-lg md:text-2xl lg:text-3xl font-bold dark:text-white" id="profitsDisplay">...</h3>
                                                </div>
                                                <svg class="hidden md:block w-8 h-8 text-[#F9D43A]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 11l3-3m0 0l3 3m-3-3v8m0-13a9 9 0 110 18 9 9 0 010-18z"></path>
                                                </svg>
                                            </div>
                                        </div>
                                    
                                        <!-- Packs Sold Card -->
                                        <div class="bg-white dark:bg-gray-800 rounded md:rounded-md lg:rounded-lg p-2 pl-2 md:pl-2 lg:pl-3 shadow-md">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <p class="text-xs md:text-base lg:text-base font-semibold text-gray-500 dark:text-gray-400">Sales</p>
                                                    <h3 class="text-lg md:text-2xl lg:text-3xl font-bold dark:text-white" id="packsSoldDisplay">...</h3>
                                                </div>
                                                <svg class="hidden md:block w-8 h-8 text-[#F9D43A]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                                                </svg>
                                            </div>
                                        </div>

                                    
                                        <!-- Inventory Count Card -->
                                        <div class="bg-white dark:bg-gray-800 rounded md:rounded-md lg:rounded-lg p-2 pl-2 md:pl-2 lg:pl-3 shadow-md">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <div>
                                                        <h3 class="text-xs md:text-sm lg:text-base font-semibold text-gray-500 dark:text-gray-400"><span class="md:hidden">Inventory</span><span class="hidden md:inline">Inventory Slots</span></h3>
                                                    </div>                                                    
                                                     <h3 class="text-lg md:text-2xl lg:text-3xl font-bold dark:text-white" id="inventoryCountDisplay">...</h3>
                                                </div>
                                                <svg class="hidden md:block w-8 h-8 text-[#F9D43A]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path>
                                                </svg>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                    <script>
                                        function updateStats() {
                                            const balance = localStorage.getItem('balance') || '0';
                                            const tProfits = localStorage.getItem('tProfits') || '0';
                                            const pSold = localStorage.getItem('pSold') || '0';
                                            const iCount = localStorage.getItem('iCount') || '0';
                                            const currency = localStorage.getItem('currency') || '1';
                                            const tier = localStorage.getItem('tier') || '1';
                                    
                                            function formatNumber(num) {
                                                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                                            }

                                            const currencySymbols = {
                                                '1': '$',
                                                '2': '£',
                                                '3': '€'
                                            };

                                            const tierSlots = {
                                                '1': 0,
                                                '2': 2,
                                                '3': 4,
                                                '4': 6,
                                                '5': 8
                                            };
                                    
                                            const symbol = currencySymbols[currency];
                                            const slots = tierSlots[tier];
                                    
                                            document.getElementById('balanceDisplay').textContent = `${symbol}${formatNumber(balance)}`;
                                            document.getElementById('profitsDisplay').textContent = `${symbol}${formatNumber(tProfits)}`;
                                            document.getElementById('packsSoldDisplay').textContent = formatNumber(pSold);
                                            document.getElementById('inventoryCountDisplay').textContent = `${formatNumber(iCount)}/${slots}`;
                                        }
                                    
                                        document.addEventListener('DOMContentLoaded', () => {
                                            updateStats();
                                            setInterval(updateStats, 2000);
                                        });
                                    </script>  

                                    <div class="flex gap-4 pt-4">
                                        <!--Product Cards Display-->
                                        <div class="w-full sm:w-3/4 lg:w-3/4 bg-transparent p-0 relative">

                                            <div class="absolute left-2 bottom-4 z-10">
                                                <button id="scrollLeft" class="p-2 md:p-2 lg:p-2 bg-[#F9D43A]/80 text-white rounded-full hover:bg-[#F9D43A]/90 active:scale-95 backdrop-blur-sm shadow-lg">
                                                    <svg class="w-6 h-6 md:w-6 md:h-6 lg:w-6 lg:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                                                    </svg>
                                                </button>
                                            </div>
                                            <div class="absolute right-2 bottom-4 z-10">
                                                <button id="scrollRight" class="p-2 md:p-2 lg:pb-2 bg-[#F9D43A]/80 text-white rounded-full hover:bg-[#F9D43A]/90 active:scale-95 backdrop-blur-sm shadow-lg">
                                                    <svg class="w-6 h-6 md:w-6 md:h-6 lg:w-6 lg:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                                    </svg>
                                                </button>
                                            </div>                                                                                        
                                            <div id="productContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                                <div class="animate-pulse flex space-x-4">
                                                    <div class="rounded-lg bg-slate-200 h-[300px] w-full"></div>
                                                </div>
                                                <div class="hidden md:flex animate-pulse space-x-4">
                                                    <div class="rounded-lg bg-slate-200 h-[300px] w-full"></div>
                                                </div>
                                                <div class="hidden lg:flex animate-pulse space-x-4">
                                                    <div class="rounded-lg bg-slate-200 h-[300px] w-full"></div>
                                                </div>
                                            </div>
                                            <script>
                                                let currentIndex = 0;
                                                let allProducts = [];

                                                const tiers = {
                                                    '1': { name: 'Explorer', color: 'bg-gray-200 text-gray-800', icon: '🌟' },
                                                    '2': { name: 'Starter', color: 'bg-blue-200 text-blue-800', icon: '⭐' },
                                                    '3': { name: 'Reseller', color: 'bg-green-200 text-green-800', icon: '💫' },
                                                    '4': { name: 'Power', color: 'bg-purple-200 text-purple-800', icon: '⚡' },
                                                    '5': { name: 'Titan', color: 'bg-yellow-200 text-yellow-800', icon: '👑' }
                                                };

                                                const currencySymbols = {
                                                    '1': '$',
                                                    '2': '£', 
                                                    '3': '€'
                                                };

                                                const currencyRates = {
                                                    '1': 1,
                                                    '2': 0.743,
                                                    '3': 0.881
                                                };

                                                function convertCurrency(amount) {
                                                    const userCurrency = localStorage.getItem('currency') || '1';
                                                    return amount * currencyRates[userCurrency];
                                                }

                                                function getCurrencySymbol() {
                                                    const userCurrency = localStorage.getItem('currency') || '1';
                                                    return currencySymbols[userCurrency];
                                                }

                                                function shuffleArray(array) {
                                                    for (let i = array.length - 1; i > 0; i--) {
                                                        const j = Math.floor(Math.random() * (i + 1));
                                                        [array[i], array[j]] = [array[j], array[i]];
                                                    }
                                                    return array;
                                                }

                                                async function fetchCodencyProducts() {
                                                    try {
                                                        const existingProducts = localStorage.getItem('codencyProducts');
                                                        if (existingProducts) {
                                                            allProducts = shuffleArray(JSON.parse(existingProducts));
                                                            displayCurrentProducts();
                                                            return;
                                                        }
                                                        
                                                        const res = await fetch('https://render-firebase-server.onrender.com/api/products');
                                                        const data = await res.json();
                                                        const shuffledData = shuffleArray([...data]);
                                                        localStorage.setItem('codencyProducts', JSON.stringify(shuffledData));
                                                        allProducts = shuffledData;
                                                        console.log('Products stored locally.');
                                                        displayCurrentProducts();
                                                    } catch (err) {
                                                        console.error('Failed to fetch product sets:', err);
                                                        const existingProducts = localStorage.getItem('codencyProducts');
                                                        if (existingProducts) {
                                                            allProducts = shuffleArray(JSON.parse(existingProducts));
                                                            displayCurrentProducts();
                                                        }
                                                    }
                                                }

                                                function displayCurrentProducts() {
                                                    const container = document.getElementById('productContainer');
                                                    if (!allProducts || allProducts.length === 0) {
                                                        console.log('No products found');
                                                        return;
                                                    }
                                                    
                                                    container.innerHTML = '';

                                                    const viewportWidth = window.innerWidth;
                                                    let productsToShow = viewportWidth >= 1024 ? 3 : viewportWidth >= 768 ? 2 : 1;
                                                    const currencySymbol = getCurrencySymbol();
                                                    const userTier = parseInt(localStorage.getItem('tier') || '1');

                                                    for(let i = 0; i < productsToShow; i++) {
                                                        const productIndex = (currentIndex + i) % allProducts.length;
                                                        const product = allProducts[productIndex];
                                                        const tierInfo = tiers[product.tier] || tiers['1'];
                                                        const isUnlocked = parseInt(product.tier) === userTier;
                                                        
                                                        const div = document.createElement('div');
                                                        div.className = 'product-card bg-white p-4 rounded-lg shadow-lg transition-all duration-300 hover:shadow-xl';
                                                        div.innerHTML = `
                                                            <div class="flex justify-center mb-0">
                                                                <img src="https://www.codency.uno/assets/app-product-images/${product.setName}.jpg" class="h-40 object-contain" alt="${product.setName}">
                                                            </div>
                                                            <div class="flex justify-between items-center mb-2">
                                                                <h3 class="font-semibold text-xs text-gray-500 dark:text-gray-400">${product.setName.length > 18 ? product.setName.substring(0, 18) + '...' : product.setName}</h3>
                                                                <span class="text-lg">${tierInfo.icon}</span>
                                                            </div>
                                                            <div class="space-y-1.5 text-sm sm:text-base">
                                                            <div class="flex items-center gap-2">
                                                                    <span class="text-sm font-medium">${product.brand}</span>
                                                                    <div class="flex-1 border-t border-gray-200 mx-2"></div>
                                                                 <span class="text-sm text-gray-600">${product.units} units</span>
                                                            </div>

                                                             <div class="flex items-center gap-1">
                                                                 <span class="text-xs text-gray-600">Cost Price: </span>
                                                                 <div class="flex-1 border-t border-gray-200 mx-2"></div>
                                                                 <span class="font-medium text-sm">${currencySymbol}${convertCurrency(product.costPerUnit).toFixed(2)}</span>
                                                              </div>

                                                              <div class="flex items-center gap-1">
                                                                 <span class="text-sm text-gray-600">S.P: </span>
                                                                 <span class="font-medium text-sm">${currencySymbol}${convertCurrency(product.sellPrice).toFixed(2)}</span>
                                                                 <div class="flex-1 border-t border-gray-200 mx-2"></div>
                                                                 <span class="text-sm text-gray-600 ml-2">ROI:</span>
                                                                 <span class="font-medium text-sm text-blue-600">${((product.sellPrice - product.costPerUnit) / product.costPerUnit * 100).toFixed(1)}%</span>
                                                              </div>
                                                                <div class="flex items-center gap-2">
                                                                    <span class="text-sm text-gray-600">Revenue Share: <span class="font-medium text-green-600">${currencySymbol}${convertCurrency((product.sellPrice - product.costPerUnit) * product.units * 0.6).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",")}</span></span>
                                                                </div>                                                            
                                                            </div>
                                                            <div class="flex justify-center mt-2">
                                                                <button 
                                                                    class="w-12 h-12 rounded-full text-sm sm:text-base transition-all duration-300 ${
                                                                        isUnlocked
                                                                        ? `${tierInfo.color} hover:opacity-90` 
                                                                        : 'bg-gray-100 text-gray-400 cursor-not-allowed'
                                                                    } flex items-center justify-center relative"
                                                                    ${!isUnlocked ? 'disabled' : ''}
                                                                        >
                                                                    <i class="fas fa-${isUnlocked ? 'plus' : 'lock'} text-lg"></i>
                                                                    <div class="absolute -top-8 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-2 py-1 rounded text-xs whitespace-nowrap transition-all duration-300 slide-label" style="opacity: 0; transform: translateY(0);">
                                                                        ${['AliExpress', 'DHgate', 'Gearbest', 'Tomtop', 'Banggood', 'LightInTheBox', 'PandaBuy', 'Alibaba',  'Chinabrands', 'TechLiquidators', 'BackMarket', 'Refurb.io', 'PlugTech', 'Mac of All Trades', 'Reboxed', 'Gazelle Bulk', 'WeSellTek', 'CExchange', 'Wholesale Ninjas', 'Direct Liquidation', 'Quicklotz', 'B-Stock', 'GENCO Marketplace', 'Bulq.com', 'BlueLots', 'BoxFox', 'Via Trading', 'PalletFly', 'Spocket', 'Oberlo', 'Modalyst', 'Printful', 'Dropified', 'Importify', 'Wholesale2B', 'CJ Dropshipping', 'Sellvia', 'Tophatter Wholesale'][Math.floor(Math.random() * 38)]}
                                                                    </div>                                                                
                                                                </button>
                                                                <style>
                                                                    @keyframes slideLabel {
                                                                        0%, 100% { opacity: 0; transform: translate(-50%, 0); }
                                                                        20%, 80% { opacity: 1; transform: translate(-50%, -100%); }
                                                                    }
                                                                    .slide-label {
                                                                        animation: slideLabel 4s ease-in-out infinite;
                                                                        animation-delay: ${Math.random() * 5 + 5}s;
                                                                    }
                                                                </style>
                                                            </div>                                                        
                                                            `;                                                        
                                                        container.appendChild(div);
                                                    }
                                                }

                                                document.getElementById('scrollLeft').addEventListener('click', () => {
                                                    currentIndex = (currentIndex - 1 + allProducts.length) % allProducts.length;
                                                    displayCurrentProducts();
                                                });

                                                document.getElementById('scrollRight').addEventListener('click', () => {
                                                    currentIndex = (currentIndex + 1) % allProducts.length;
                                                    displayCurrentProducts();
                                                });

                                                document.addEventListener('DOMContentLoaded', fetchCodencyProducts);
                                                window.addEventListener('resize', displayCurrentProducts);
                                            </script>                                        
                                        </div>

                                        <!---Quick Links/ Overview-->
                                        <div id="right-panel" class="hidden sm:block sm:w-1/3 lg:w-1/3 bg-white p-3 rounded-lg shadow-lg">
                                        <div id="deposit-content" class="space-y-4">

                                            <!-- Default Overview + Add Funds Panel -->
                                            <div id="default-section">
                                            <div class="border-b pb-2">
                                                <h3 class="text-base font-semibold text-gray-500">Overview</h3>
                                                <div class="text-sm text-gray-500 space-y-1 mt-2">
                                                <div class="flex justify-between"><span>Total Invested</span><span class="font-medium">$0.00</span></div>
                                                <div class="flex justify-between"><span>Portfolio Value</span><span class="font-medium text-green-600">$0.00</span></div>
                                                <div class="flex justify-between"><span>Overall ROI</span><span class="font-medium text-blue-600">0%</span></div>
                                                </div>
                                            </div>

                                            <div class="border-b pb-2">
                                                <h3 class="text-base font-semibold text-gray-500">Ad Performance</h3>
                                                <div class="text-sm text-gray-500 space-y-1 mt-2">
                                                <div class="flex justify-between"><span>Impressions</span><span class="font-medium">0</span></div>
                                                <div class="flex justify-between"><span>CTR</span><span class="font-medium">0%</span></div>
                                                <div class="flex justify-between"><span>Ad Spend</span><span class="font-medium">$0.00</span></div>
                                                </div>
                                            </div>

                                            <div class="flex gap-2 mt-3 mb-3">
                                                <button onclick="startDeposit()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white text-xs py-2 px-3 rounded-lg transition-colors">
                                                <i class="fas fa-wallet mr-1"></i> Add Funds
                                                </button>
                                                <button onclick="startCashout()" class="flex-1 bg-green-500 hover:bg-green-600 text-white text-xs py-2 px-3 rounded-lg transition-colors">
                                                <i class="fas fa-exchange-alt mr-1"></i> Cash Out
                                                </button>
                                            </div>

                                            <div id="tipContainer" class="text-sm text-gray-600 italic p-2 bg-gray-50 rounded-lg opacity-0 transition-opacity duration-500"></div>
                                            </div>

                                            <!-- Step 1: Deposit Reason and Method -->
                                            <div id="method-selection" class="hidden text-center space-y-4">
                                            <div class="flex justify-center items-center">
                                                <h3 class="text-base font-semibold text-gray-700 mr-4"><i class="fas fa-credit-card mr-2"></i>Choose Deposit Method</h3>
                                                <button onclick="cancelDeposit()" class="text-sm text-gray-500 hover:text-red-500 ml-4"><i class="fas fa-times"></i></button>
                                            </div>
                                            <p class="text-sm text-gray-500">
                                                Codency Uno uses gift cards like Apple & Nike as verified value tokens. They're fast, secure, and help us keep deposits smooth and fraud-free.
                                            </p>
                                            <div class="flex justify-center gap-6">
                                                <button onclick="selectMethod('Apple')" class="w-16 h-16 rounded-full bg-gray-100 hover:bg-gray-200"><img src="https://www.codency.uno/app-images/apple-logo.jpg" alt="Apple" class="w-full h-full object-cover rounded-full"></button>
                                                <button onclick="selectMethod('Nike')" class="w-16 h-16 rounded-full bg-gray-100 hover:bg-gray-200"><img src="https://www.codency.uno/app-images/nike-logo.webp" alt="Nike" class="w-full h-full object-cover rounded-full"></button>
                                            </div>
                                            </div>

                                            <!-- Cashout Form -->
                                            <div id="cashout-form" class="hidden space-y-4">
                                                <div class="flex justify-between items-center">
                                                    <h3 class="text-base font-semibold text-gray-700"><i class="fas fa-university mr-2"></i>Cash Out</h3>
                                                    <button onclick="cancelCashout()" class="text-sm text-gray-500 hover:text-red-500"><i class="fas fa-times"></i></button>
                                                </div>
                                                
                                                <div class="bg-gray-50 p-3 rounded-lg" style="display: none;">
                                                    <h4 class="text-sm font-medium text-gray-700 mb-2">Bank Details</h4>
                                                    <div id="bankInfo" class="text-xs text-gray-600 space-y-1">
                                                        <div><span class="font-medium">Account Name: </span> <span id="accountName"></span></div>
                                                        <div><span class="font-medium">Account Number: </span> <span id="accountNumber"></span></div>
                                                        <div><span class="font-medium">Bank Name: </span> <span id="bankName"></span></div>
                                                    </div>
                                                </div>
                                                <script>
                                                    const bankInfos = localStorage.getItem('bankInfo');
                                                    if (bankInfos) {
                                                        const [name, number, bank] = bankInfos.split(',').map(item => item.trim());
                                                        document.getElementById('accountName').textContent = name;
                                                        document.getElementById('accountNumber').textContent = number;
                                                        document.getElementById('bankName').textContent = bank;
                                                        document.getElementById('bankInfo').style.display = 'block';
                                                    } else {
                                                        document.write(`
                                                            <div class="flex flex-col items-center justify-center py-2">
                                                                <svg class="w-16 h-16 text-gray-300 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                                                </svg>
                                                                <p class="text-gray-500 text-sm">No bank account added yet</p>
                                                                <button class="flex items-center text-sm text-[#F9D43A] hover:text-text-[#F9D43A]">
                                                                    <i class="fas fa-plus-circle mr-2"></i>
                                                                    Add Bank Account
                                                                </button>
                                                            </div>
                                                        `);
                                                    }
                                                </script>
                                                <form id="cashout-amount-form" class="space-y-3">
                                                    <div class="flex gap-2">
                                                        <label class="block flex-1">
                                                            <span class="text-gray-700 text-xs">Amount</span>
                                                            <input type="number" name="cashoutAmount" class="mt-1 w-full px-2 py-1.5 border rounded-md text-xs" required>
                                                        </label>

                                                        <label class="block w-24">
                                                            <span class="text-gray-700 text-xs">Currency</span>
                                                            <select name="cashoutCurrency" id="currencySelect3" class="mt-1 w-full px-2 py-1.5 border rounded-md text-xs appearance-none" disabled>
                                                                <option value="1">USD</option>
                                                                <option value="2">GBP</option>
                                                                <option value="3">EUR</option>
                                                            </select>
                                                        </label>
                                                    </div>
                                                    <button type="submit" class="w-1/2 mx-auto block bg-[#F9D43A] text-white py-1.5 rounded-md hover:bg-[#F9D43A] transition text-sm disabled:opacity-50 disabled:cursor-not-allowed" disabled>Transfer Funds</button>
                                                </form>
                                            </div>

                                            <!-- Step 2: Deposit Form -->
                                            <form id="deposit-form" class="hidden space-y-3 text-xs">
                                            <div class="flex flex-col items-center mb-3">
                                                <div class="w-full relative mb-2">
                                                    <button onclick="cancelDeposit()" type="button" class="absolute top-0 right-0 text-gray-500 hover:text-red-500">
                                                        <i class="fas fa-times text-base"></i>
                                                    </button>
                                                    <div id="method-image" class="w-full flex justify-center items-center mt-4">
                                                        <div class="w-48 h-24">
                                                            <img src="https://www.codency.uno/app-images/apple-bg.png" alt="Apple" class="w-full h-full object-contain hidden" id="apple-image">
                                                            <img src="https://www.codency.uno/app-images/nike-bg.png" alt="Nike" class="w-full h-full object-contain hidden" id="nike-image">
                                                        </div>
                                                    </div>
                                                </div>
                                                <h3 id="form-title" class="text-sm font-semibold text-gray-700 text-center">Deposit with Gift Card</h3>
                                            </div>

                                            <label class="block">
                                                <span class="text-gray-700 text-xs">Card Code</span>
                                                <input type="text" name="cardCode" class="mt-1 w-full px-2 py-1.5 border rounded-md text-xs" required oninput="this.value = this.value.toUpperCase()" style="text-transform: uppercase;">
                                            </label>

                                            <div class="flex gap-2">
                                                
                                                <label class="block flex-1">
                                                    <span class="text-gray-700 text-xs">Amount</span>
                                                    <input type="number" name="amount" class="mt-1 w-full px-2 py-1.5 border rounded-md text-xs" required>
                                                </label>

                                                <label class="block w-24">
                                                    <span class="text-gray-700 text-xs">Currency</span>
                                                    <select name="currency" id="currencySelect2" class="mt-1 w-full px-2 py-1.5 border rounded-md text-xs appearance-none" disabled>
                                                    <option value="1">USD</option>
                                                    <option value="2">GBP</option>
                                                    <option value="3">EUR</option>
                                                    </select>
                                                </label>                                                                                                
                                            </div>

                                            <script>
                                                document.addEventListener('DOMContentLoaded', function() {
                                                    const currencySelect = document.getElementById('currencySelect2');
                                                    const currencySelect3 = document.getElementById('currencySelect3');
                                                    const savedCurrency = localStorage.getItem('currency');
                                                    if (savedCurrency) {
                                                        currencySelect.value = savedCurrency;
                                                        currencySelect3.value = savedCurrency;
                                                    }

                                                    const bankInfo = document.getElementById('bankInfo');
                                                    const savedBankData = JSON.parse(localStorage.getItem('bankInfo') || '{}');
                                                    if(savedBankData.bank) {
                                                        bankInfo.innerHTML = `
                                                            <p><strong>Bank:</strong> ${savedBankData.bank}</p>
                                                            <p><strong>Account Name:</strong> ${savedBankData.accountName}</p>
                                                            <p><strong>Account Number:</strong> ${savedBankData.accountNumber}</p>
                                                        `;
                                                    }
                                                });

                                                function startCashout() {
                                                    document.getElementById('default-section').style.display = 'none';
                                                    document.getElementById('cashout-form').style.display = 'block';
                                                }

                                                function cancelCashout() {
                                                    document.getElementById('cashout-form').style.display = 'none';
                                                    document.getElementById('default-section').style.display = 'block';
                                                }
                                            </script>

                                            <label class="flex items-center gap-2 mt-2">
                                                <input type="checkbox" id="physical-toggle" onchange="togglePhysical(this)" class="h-3 w-3 text-blue-600">
                                                <span class="text-xs">I have a physical card</span>
                                            </label>

                                            <div id="physical-upload" class="hidden space-y-2 mt-2">
                                                <label class="block">
                                                <span class="text-gray-700 text-xs">Upload Card Image</span>
                                                <input type="file" name="cardImage" accept="image/*" class="mt-1 block w-full text-xs">
                                                </label>
                                                <label class="block">
                                                <span class="text-gray-700 text-xs">Upload Receipt</span>
                                                <input type="file" name="receiptImage" accept="image/*" class="mt-1 block w-full text-xs">
                                                </label>
                                                <p class="text-xs text-gray-500 italic">Uploading a photo helps us verify your card faster.</p>
                                            </div>

                                            <button type="submit" class="w-1/2 mx-auto block bg-[#F9D43A] text-gray-50 py-1.5 rounded-md hover:bg-[#F9D43A]/110 transition text-sm">Submit Deposit</button>                                            
                                        </form>
                                        </div>

                                        <script>
                                            const tipContainer = document.getElementById('tipContainer');
                                            const tips = [
                                            "💡 Tip: You earn more by holding premium product sets",
                                            "📦 Product earnings release after 10–15 working days post-sale",
                                            "🎯 Tip: Diversify your portfolio across different categories",
                                            "💰 Higher tier products offer better profit margins",
                                            "👌 Quick scaling: Reinvest profits into new product sets",
                                            "😉 Regular portfolio updates increase earning potential"
                                            ];
                                            let currentTipIndex = 0;

                                            function showNextTip() {
                                            tipContainer.style.opacity = '0';
                                            setTimeout(() => {
                                                tipContainer.textContent = tips[currentTipIndex];
                                                tipContainer.style.opacity = '1';
                                                currentTipIndex = (currentTipIndex + 1) % tips.length;
                                            }, 500);
                                            }
                                            showNextTip();
                                            setInterval(showNextTip, 20000);

                                            // UI Functions
                                            function startDeposit() {
                                            document.getElementById('default-section').style.display = 'none';
                                            document.getElementById('method-selection').style.display = 'block';
                                            }

                                            function cancelDeposit() {
                                            document.getElementById('method-selection').style.display = 'none';
                                            document.getElementById('deposit-form').style.display = 'none';
                                            document.getElementById('physical-upload').style.display = 'none';
                                            document.getElementById('default-section').style.display = 'block';
                                            }

                                            function selectMethod(method) {
                                            document.getElementById('method-selection').style.display = 'none';
                                            document.getElementById('form-title').textContent = `Deposit with ${method} Gift Card`;
                                            document.getElementById('deposit-form').style.display = 'block';
                                            // Hide all images first
                                            document.getElementById('apple-image').style.display = 'none';
                                            document.getElementById('nike-image').style.display = 'none';
                                            // Show only the selected method's image
                                            document.getElementById(`${method.toLowerCase()}-image`).style.display = 'block';
                                            }

                                            function togglePhysical(checkbox) {
                                            document.getElementById('physical-upload').style.display = checkbox.checked ? 'block' : 'none';
                                            }
                                        </script>
                                        
                                        </div>

                                    </div>                                   
                            </div>
                            
                            <!-- Inventory Section -->
                            <div id="inventory" class="section hidden overflow-y-auto">
                                <div class="bg-white dark:bg-gray-800 rounded-lg p-2 md:p-3 lg:p-4 mb-2 md:mb-3 lg:mb-4">
                                        <div class="flex items-center gap-1 lg:gap-2">
                                            <video autoplay loop muted playsinline class="w-14 h-14 sm:w-16 sm:h-16 md:w-18 md:h-18 lg:w-24 lg:h-24 rounded-lg">
                                                <source src="https://www.codency.uno/assets/app-images/inventory.webm" type="video/webm">
                                            </video>
                                            <h2 class="text-base md:text-lg lg:text-xl font-bold dark:text-white">My Portfolio</h2>
                                        </div>
                                
                                                        <div class="grid grid-cols-3 md:grid-cols-3 lg:grid-cols-3 gap-1 md:gap-2 lg:gap-3">
                                                            <!-- Total Items Card -->
                                                            <div class="bg-white p-2 md:p-3 lg:p-4 rounded-lg shadow-md">
                                                                <div class="flex items-center justify-between mb-1 md:mb-2 lg:mb-3">
                                                                    <h3 class="text-xs md:text-sm lg:text-base font-semibold text-gray-700"><span class="md:hidden">Packs</span><span class="hidden md:inline">Total Products</span></h3>                                                                    <i class="fas fa-boxes text-blue-500 text-base md:text-lg lg:text-xl"></i>
                                                                </div>
                                                                <p class="text-lg md:text-xl lg:text-2xl font-bold text-gray-800">0</p>
                                                                <p class="hidden md:block text-xs md:text-sm lg:text-base text-gray-500 mt-2">Products in Inventory</p>                                                            
                                                            </div>

                                                            <!-- Estimated Profit Card -->
                                                            <div class="bg-white p-2 md:p-3 lg:p-4 rounded-lg shadow-md">
                                                                <div class="flex items-center justify-between mb-1 md:mb-2 lg:mb-3">
                                                                    <h3 class="text-xs md:text-sm lg:text-base font-semibold text-gray-700"><span class="md:hidden">Profits</span><span class="hidden md:inline">Total Profit</span></h3>                                                                    <i class="fas fa-chart-line text-green-500 text-base md:text-lg lg:text-xl"></i>
                                                                </div>
                                                                <p class="text-lg md:text-xl lg:text-2xl font-bold text-gray-800">$0</p>
                                                                <p class="hidden md:block text-xs md:text-sm lg:text-base text-gray-500 mt-2">Based on current inventory</p>
                                                            </div>

                                                            <!-- Total ROI Card -->
                                                            <div class="bg-white p-2 md:p-3 lg:p-4 rounded-lg shadow-md">
                                                                <div class="flex items-center justify-between mb-1 md:mb-2 lg:mb-3">
                                                                    <h3 class="text-xs md:text-sm lg:text-base font-semibold text-gray-700"><span class="md:hidden">ROIs</span><span class="hidden md:inline lg:hidden">Total ROI</span><span class="hidden lg:inline">Total ROI</span></h3>                                                                    <i class="fas fa-percent text-yellow-500 text-base md:text-lg lg:text-xl"></i>
                                                                </div>
                                                                <p class="text-lg md:text-xl lg:text-2xl font-bold text-gray-800">0</p>
                                                                <p class="hidden md:block text-xs md:text-sm lg:text-base text-gray-500 mt-2">Based on current inventory</p>
                                                            </div>                                                            
                                                        </div>

                                                        <!-- Inventory products -->
                                                        <div class="mt-6 bg-white p-2 md:p-3 lg:p-4 rounded-lg shadow-md flex flex-col min-h-0 flex-1">
                                                            <h3 class="text-xs md:text-sm lg:text-base font-semibold text-gray-700 mb-2 md:mb-3 lg:mb-4">Inventory Products</h3>
                                                                <div class="overflow-auto flex-1" style="max-height: 300px;">
                                                                    <style>
                                                                        @media (min-width: 768px) {
                                                                            .overflow-auto {
                                                                        max-height: 160px !important;
                                                                            }
                                                                        }
                                                                        @media (min-width: 1024px) {
                                                                        .overflow-auto {
                                                                            max-height: 160px !important;
                                                                            }
                                                                        }
                                                                    </style>                                                                
                                                                <table class="min-w-full">
                                                                    <thead class="bg-gray-50 sticky top-0">
                                                                        <tr class="hidden lg:table-row">
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Product</th>
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Units</th>
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Expected ROI</th>
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Projected Gains</th>
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Order Status</th> 
                                                                        </tr>

                                                                        <tr class="hidden md:table-row lg:hidden">
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Product</th>
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">ROI</th>
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Profit</th>
                                                                            <th class="px-2 py-2 text-left text-sm font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                                        </tr>

                                                                        <tr class="table-row md:hidden">
                                                                            <th class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product</th>
                                                                            <th class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Profit</th>
                                                                            <th class="px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                                        </tr>

                                                                    </thead>

                                                                    <tbody class="bg-white divide-y divide-gray-200">
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">No products</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden md:table-cell">-</td>
                                                                            <td class="px-2 py-2 whitespace-nowrap text-xs md:text-sm lg:text-sm text-gray-600 hidden lg:table-cell">-</td>
                                                                        </tr>
                                                                    </tbody>                                                                
                                                                </table>
                                                            </div>
                                                        </div>

                                                        <!-- Quick Actions -->
                                                        <div class="mt-6 grid grid-cols-2 md:grid-cols-4 gap-4">
                                                            <button class="flex items-center justify-center gap-2 bg-blue-50 p-3 rounded-lg hover:bg-blue-100 transition-colors">
                                                                <i class="fas fa-plus text-blue-500 text-sm md:text-base lg:text-lg"></i>
                                                                <span class="text-xs md:text-sm lg:text-base text-blue-700">Add Product Set</span>
                                                            </button>
                                                            <button class="flex items-center justify-center gap-2 bg-green-50 p-3 rounded-lg hover:bg-green-100 transition-colors">
                                                                <i class="fas fa-file-export text-green-500 text-sm md:text-base lg:text-lg"></i>
                                                                <span class="text-xs md:text-sm lg:text-base text-green-700">Export</span>
                                                            </button>
                                                            <button class="flex items-center justify-center gap-2 bg-purple-50 p-3 rounded-lg hover:bg-purple-100 transition-colors">
                                                                <i class="fas fa-sync text-purple-500 text-sm md:text-base lg:text-lg"></i>
                                                                <span class="text-xs md:text-sm lg:text-base text-purple-700">Sync</span>
                                                            </button>
                                                            <button class="flex items-center justify-center gap-2 bg-gray-50 p-3 rounded-lg hover:bg-gray-100 transition-colors">
                                                                <i class="fas fa-cog text-gray-500 text-sm md:text-base lg:text-lg"></i>
                                                                <span class="text-xs md:text-sm lg:text-base text-gray-700">Settings</span>
                                                            </button>
                                                        </div>
                                </div>
                            </div>

                            <!-- Notifications Section -->
                            <div id="notifications" class="section hidden bg-white dark:bg-gray-800 rounded-lg p-6 mb-8">
                            <h2 class="text-2xl font-bold mb-4 dark:text-white">Notifications</h2>
                            <p class="text-gray-600 dark:text-gray-300">Your notifications content goes here.</p>
                            </div>

                            <!-- Marketing Section -->
                            <div id="marketing" class="section hidden bg-white dark:bg-gray-800 rounded-lg p-6 mb-8">
                            <h2 class="text-2xl font-bold mb-4 dark:text-white">Marketing Tools</h2>
                            <p class="text-gray-600 dark:text-gray-300">Your marketing tools content goes here.</p>
                            </div>


                            <!-- Profile Section -->
                            <div id="profile" class="section hidden overflow-y-auto">
                                
                                    <div class="bg-white rounded-lg p-2 md:p-3 lg:p-4 mb-2 md:mb-2 lg:mb-2">

                                        <div class="flex flex-col sm:flex-row justify-between items-start mb-1 sm:mb-1 md:mb-1 lg:mb-1">
                                            <div class="flex items-center gap-1 lg:gap-2">
                                                <video class="w-14 h-14 sm:w-16 sm:h-16 md:w-18 md:h-18 lg:w-24 lg:h-24 rounded-full" autoplay loop muted playsinline>
                                                    <source src="https://www.codency.uno/assets/app-images/user1.webm" type="video/webm">
                                                </video>
                                                     <h2 class="text-base md:text-lg lg:text-xl font-bold text-gray-800">Your Profile</h2>
                                            </div>
                                        </div> 

                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2 md:gap-3 lg:gap-4">

                                            <div class="space-y-4">
                                                <!--Personal information-->
                                                <div class="bg-white p-2 md:p-3 lg:p-4 shadow-md rounded md:rounded-md lg:rounded-lg">
                                                    <h3 class="text-sm md:text-base lg:text-base font-semibold text-gray-700 mb-2 md:mb-3 lg:mb-4">Personal Information</h3>
                                                    <div class="space-y-3 md:space-y-4 lg:space-y-5">
                                                        <div class="flex items-center">
                                                            <i class="fas fa-user-circle text-gray-400 w-6 md:w-8 lg:w-8"></i>
                                                            <span class="text-xs text-gray-600 md:text-sm lg:text-base"><script>document.write(localStorage.getItem('userName') || 'Name')</script></span>
                                                        </div>
                                                        <div class="flex items-center">
                                                            <i class="fas fa-envelope-open-text text-gray-400 w-6 md:w-8 lg:w-8"></i>
                                                            <span class="text-xs text-gray-600 md:text-base lg:text-base"><script>document.write(localStorage.getItem('email') || 'Email')</script></span>
                                                        </div>
                                                        <div class="flex items-center">
                                                            <i class="fas fa-globe-americas text-gray-400 w-6 md:w-8 lg:w-8"></i>
                                                            <span class="text-gray-600 text-xs md:text-base lg:text-base"><script>document.write(localStorage.getItem('country') || 'Country')</script></span>
                                                        </div>
                                                    </div>
                                                </div>

                                                
                                                <!--KYC information-->
                                                <div class="bg-white p-2 md:p-3 lg:p-4 rounded md:rounded-md lg:rounded-lg shadow-md mt-2 !mt-2 md:!mt-4 lg:!mt-6">
                                                    <div class="flex items-center justify-between mb-4">
                                                        <h3 class="text-sm md:text-base lg:text-base font-semibold text-gray-700">Identity Unlock</h3>
                                                        <script>
                                                            const kycStatus = localStorage.getItem('kycStatus') || 'unverified';
                                                            document.write(`
                                                                <span class="${kycStatus === 'verified' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'} px-2 py-1 rounded text-xs md:text-sm lg:text-base">
                                                                    ${kycStatus === 'verified' ? 'Verified' : 'Unverified'}
                                                                </span>
                                                            `);
                                                        </script>
                                                    </div>
                                                    <div class="w-full bg-gray-200 h-2 rounded-full mt-2">
                                                        <script>
                                                            document.write(`
                                                                <div class="w-[${kycStatus === 'verified' ? '100' : '0'}%] bg-yellow-400 h-2 rounded-full"></div>
                                                            `);
                                                        </script>
                                                    </div>
                                                    <p class="text-xs text-gray-500 mt-1 mb-2">
                                                        <script>
                                                            document.write(`${kycStatus === 'verified' ? '100' : '0'}% profile complete`);
                                                        </script>
                                                    </p>
                                                    <div class="space-y-3">
                                                        <div class="flex items-center">
                                                            <i class="fas fa-id-card text-gray-400 w-6"></i>
                                                            <script>
                                                                document.write(`
                                                                    <span class="text-xs md:text-base lg:text-base text-gray-600">
                                                                        ${kycStatus === 'verified' ? 'ID Verified' : 'ID Verification Required'}
                                                                    </span>
                                                                `);
                                                            </script>
                                                        </div>
                                                        <div class="flex items-center">
                                                            <i class="fas fa-address-card text-gray-400 w-6"></i>
                                                            <script>
                                                                document.write(`
                                                                    <span class="text-xs md:text-base lg:text-base text-gray-600">
                                                                        ${kycStatus === 'verified' ? 'Address Verified' : 'Address Verification Required'}
                                                                    </span>
                                                                `);
                                                            </script>
                                                        </div>
                                                        <div class="flex items-center">
                                                            <i class="fas fa-shield-alt text-gray-400 w-6"></i>
                                                            <script>
                                                                document.write(`
                                                                    <span class="text-xs md:text-base lg:text-base text-gray-600">
                                                                        ${kycStatus === 'verified' ? 'SSN: ***-**-****' : 'SSN Verification Required'}
                                                                    </span>
                                                                `);
                                                            </script>
                                                        </div>
                                                        <script>
                                                            if (kycStatus !== 'verified') {
                                                                document.write(`
                                                                    <div class="flex justify-start">
                                                                        <button class="bg-[#F9D43A] text-white py-1 md:py-2 lg:py-3 px-2 md:px-4 lg:px-6 rounded-lg text-xs md:text-sm lg:text-base hover:opacity-90">
                                                                            Verify Now
                                                                        </button>
                                                                    </div>
                                                                `);
                                                            }
                                                        </script>
                                                    </div>
                                                </div>
                                                
                                            </div>

                                            <div class="space-y-4">
                                                <!--Connected Accounts-->
                                                <div class="bg-white p-2 md:p-3 lg:p-4 rounded md:rounded-md lg:rounded-lg shadow-md">
                                                    <h3 class="text-sm md:text-base lg:text-base font-semibold text-gray-700 mb-2">Withdrawal Account</h3>
                                                    <div class="space-y-3">
                                                        <div class="flex items-center justify-between">
                                                            <div class="flex items-center">
                                                                <i class="fas fa-university text-gray-400 mr-2"></i>
                                                                <div class="flex flex-col">
                                                                    <span class="text-xs md:text-base lg:text-base text-gray-600">Bank Wire</span>
                                                                    <span class="text-xs md:text-sm lg:text-sm text-gray-500">Bi-weekly transfers (Fridays)</span>
                                                                </div>
                                                            </div>
                                                            <span class="text-xs md:text-base lg:text-base text-green-600 text-sm" style="display: none" id="connectedStatus">Connected</span>
                                                        </div>
                                                        <script>
                                                            const bankInfo = localStorage.getItem('bankInfo');
                                                            const connectedStatus = document.getElementById('connectedStatus');
                                                            if (bankInfo) {
                                                                connectedStatus.style.display = 'inline';
                                                                const [name, account, bank, type] = bankInfo.split(',');
                                                                document.write(`
                                                                    <div class="mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200">
                                                                        <div class="grid grid-cols-2 gap-2 text-xs md:text-base lg:text-base">
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-500">Account Holder:</div>
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-700 font-medium">${name}</div>
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-500">Account Number:</div>
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-700 font-medium">****${account.slice(-4)}</div>
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-500">Bank Name:</div>
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-700 font-medium">${bank}</div>
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-500">Account Type:</div>
                                                                            <div class="text-xs md:text-base lg:text-base text-gray-700 font-medium">${type}</div>
                                                                        </div>
                                                                    </div>
                                                                `);
                                                            } else {
                                                                document.write(`
                                                                    <div class="flex flex-col items-center justify-center py-2 md:py-4 lg:py-6">
                                                                        <svg class="w-16 h-16 text-gray-300 mb-2 lg:mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                                                        </svg>
                                                                        <p class="text-gray-500 text-xs md:text-sm lg:text-base mb-4">No bank account added yet</p>
                                                                        <button class="flex items-center text-xs md:text-sm lg:text-base text-[#F9D43A] hover:text-text-[#F9D43A]">
                                                                            <i class="fas fa-plus-circle mr-2"></i>
                                                                            Add Bank Account
                                                                        </button>
                                                                    </div>
                                                                `);
                                                            }
                                                        </script>
                                                    </div>
                                                </div>
                                                
                                            </div>
                                        </div>
                                    </div>
                            </div>

                        </div>
                        

                             <!-- Floating Toggle Button (NOT inside dock) -->
                                <button id="toggleDock"
                                    class="fixed bottom-[1%] right-6 bg-[#F9D43A] text-sm text-gray-50 px-4 py-1 text-sm rounded-full shadow-lg flex items-center gap-2 hover:bg-[#F9D43A] z-50 block md:hidden">
                                    <i id="arrowIcon" class="fas fa-chevron-up"></i>
                                    Open Panel
                                </button>


                                <!-- 🔲 Overlay (initially hidden) -->
                                <div id="overlay"
                                class="fixed inset-0 bg-black bg-opacity-60 z-30 transition-opacity duration-300 opacity-0 pointer-events-none">
                                </div>


                                <!-- ✅ Bottom Dock (Hidden by default) -->
                                <div id="dock"
                                    class="fixed bottom-0 left-0 w-full bg-white shadow-lg z-40 transition-all duration-500 overflow-hidden"
                                    style="height: 0;">
                                    
                                    <div id="dockContent" class="sm:w-1/3 lg:w-1/3 mx-auto bg-white p-3 rounded-t-lg shadow-inner">
                                    <div class="space-y-4">

                                        <!-- Overview -->
                                        <div class="border-b pb-2">
                                        <h3 class="text-base font-semibold text-gray-500">Overview</h3>
                                        <div class="text-sm text-gray-500 space-y-1 mt-2">
                                            <div class="flex justify-between"><span>Total Invested</span><span class="font-medium">$0.00</span></div>
                                            <div class="flex justify-between"><span>Portfolio Value</span><span class="font-medium text-green-600">$0.00</span></div>
                                            <div class="flex justify-between"><span>Overall ROI</span><span class="font-medium text-blue-600">0%</span></div>
                                        </div>
                                        </div>

                                        <!-- Ad Performance -->
                                        <div class="border-b pb-2">
                                        <h3 class="text-base font-semibold text-gray-500">Ad Performance</h3>
                                        <div class="text-sm text-gray-500 space-y-1 mt-2">
                                            <div class="flex justify-between"><span>Impressions</span><span class="font-medium">0</span></div>
                                            <div class="flex justify-between"><span>CTR</span><span class="font-medium">0%</span></div>
                                            <div class="flex justify-between"><span>Ad Spend</span><span class="font-medium">$0.00</span></div>
                                        </div>
                                        </div>

                                        <!-- Action Buttons -->
                                        <div class="flex gap-2">
                                        <button class="flex-1 bg-blue-500 hover:bg-blue-600 text-white text-xs py-2 px-3 rounded-lg transition-colors">
                                            <i class="fas fa-wallet mr-1"></i> Add Funds
                                        </button>
                                        <button class="flex-1 bg-green-500 hover:bg-green-600 text-white text-xs py-2 px-3 rounded-lg transition-colors">
                                            <i class="fas fa-exchange-alt mr-1"></i> Cash Out
                                        </button>
                                        </div>

                                        <!-- Tip Section -->
                                        <div id="tipContainerz"
                                        class="text-sm text-gray-600 italic p-2 bg-gray-50 rounded-lg opacity-0 transition-opacity duration-500">
                                        </div>

                                    </div>
                                    </div>
                                </div>

                                <!-- ✅ Toggle Script + Tip Cycler -->
                                <script>
                                    const toggleBtn = document.getElementById('toggleDock');
                                    const dock = document.getElementById('dock');
                                    const overlay = document.getElementById('overlay');
                                    const arrowIcon = document.getElementById('arrowIcon');
                                    let isOpen = false;

                                    toggleBtn.addEventListener('click', () => {
                                    isOpen = !isOpen;

                                    dock.style.height = isOpen ? 'auto' : '0';

                                    toggleBtn.innerHTML = `
                                        <i id="arrowIcon" class="fas ${isOpen ? 'fa-chevron-down' : 'fa-chevron-up'}"></i>
                                        ${isOpen ? 'Close Panel' : 'Open Panel'}
                                    `;

                                    overlay.classList.toggle('opacity-0', !isOpen);
                                    overlay.classList.toggle('opacity-100', isOpen);
                                    overlay.classList.toggle('pointer-events-none', !isOpen);
                                    });

                                    overlay.addEventListener('click', () => {
                                    isOpen = false;
                                    dock.style.height = '0';
                                    toggleBtn.innerHTML = `
                                        <i id="arrowIcon" class="fas fa-chevron-up"></i>
                                        Open Panel
                                    `;
                                    overlay.classList.add('opacity-0', 'pointer-events-none');
                                    overlay.classList.remove('opacity-100');
                                    });

                                    // 🔁 Tips rotation
                                    const tipsz = [
                                    "💡 Tip: You earn more by holding premium product sets",
                                    "📦 Product earnings release after 10–15 working days post-sale",
                                    "🎯 Tip: Diversify your portfolio across different categories",
                                    "💰 Higher tier products offer better profit margins",
                                    "👌 Quick scaling: Reinvest profits into new product sets",
                                    "😉 Regular portfolio updates increase earning potential"
                                    ];
                                    let currentTipIndexz = 0;
                                    const tipContainerz = document.getElementById('tipContainerz');

                                    function showNextTipz() {
                                    tipContainerz.style.opacity = '0';
                                    setTimeout(() => {
                                        tipContainerz.textContent = tips[currentTipIndexz];
                                        tipContainerz.style.opacity = '1';
                                        currentTipIndexz = (currentTipIndexz + 1) % tips.length;
                                    }, 500);
                                    }

                                    showNextTipz();
                                    setInterval(showNextTipz, 20000);
                                </script>

                            <!-- Settings and Currency Controls -->
                            <div class="fixed h-8 top-1 md:top-4 lg:top-4 right-4 flex space-x-2 lg:space-x-4">
                                <div id="tierBadge" class="inline-flex items-center px-3 py-1 rounded-full text-xs md:text-sm lg:text-sm font-medium cursor-pointer">
                                <span class="mr-1.5" id="tierIcon"></span>
                                <span id="tierLabel" class="hidden md:block"></span>
                            </div>
                            <script>
                                document.getElementById('tierBadge').addEventListener('click', function() {
                                    const tierLabel = document.getElementById('tierLabel');
                                    if (window.innerWidth < 768) {
                                        tierLabel.classList.remove('hidden');
                                        setTimeout(() => {
                                            tierLabel.classList.add('hidden');
                                        }, 4000);
                                    }
                                });
                            </script>

                            <select id="currencySelect" class="appearance-none w-full p-2 md:pt-1.5 lg:pt-1.5 rounded-lg bg-gray-200 dark:bg-gray-700 text-xs md:text-sm lg:text-sm text-gray-800 dark:text-white pr-2">
                                <option value="1">USD</option>
                                <option value="2">GBP</option>
                                <option value="3">EUR</option>
                            </select> 
                    
                            <script>
                            document.getElementById('currencySelect').addEventListener('change', function() {
                                const selectedCurrency = this.value;
                                localStorage.setItem('currency', selectedCurrency);
                                
                                // Post to endpoint
                                fetch('/api/currency', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                },
                                body: JSON.stringify({
                                    currency: selectedCurrency
                                })
                                });
                            });

                            // Set initial value from localStorage
                            const savedCurrency = localStorage.getItem('currency');
                            if (savedCurrency) {
                                document.getElementById('currencySelect').value = savedCurrency;
                            }
                            </script>
                            </div>

                            <!-- Tier Badge Logic -->
                            <script>
                                            let tierInterval;
                                            
                                            function updateTier() {
                                            const tier = localStorage.getItem('tier') || '1';
                                            const tierBadge = document.getElementById('tierBadge');
                                            const tierIcon = document.getElementById('tierIcon');
                                            const tierLabel = document.getElementById('tierLabel');

                                            const tiers = {
                                                '1': { name: 'Explorer', color: 'bg-gray-200 text-gray-800', icon: '🌟' },
                                                '2': { name: 'Starter', color: 'bg-blue-200 text-blue-800', icon: '⭐' },
                                                '3': { name: 'Reseller', color: 'bg-green-200 text-green-800', icon: '💫' },
                                                '4': { name: 'Power', color: 'bg-purple-200 text-purple-800', icon: '⚡' },
                                                '5': { name: 'Titan', color: 'bg-yellow-200 text-yellow-800', icon: '👑' }
                                            };

                                            const currentTier = tiers[tier];
                                            tierBadge.className = `inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${currentTier.color}`;
                                            tierIcon.textContent = currentTier.icon;
                                            tierLabel.textContent = currentTier.name;
                                            }

                                            document.addEventListener('DOMContentLoaded', function() {
                                                updateTier();
                                                tierInterval = setInterval(updateTier, 2000);
                                            });
                            </script>


                            <!--Login Process and User Data Fetch-->
                            <script>
                                (async () => {
                                    const params = new URLSearchParams(window.location.search);
                                    const tokenFromURL = params.get("token");

                                    if (tokenFromURL) {
                                    // Save new login token from magic link
                                    localStorage.setItem("loginToken", tokenFromURL);

                                    // Optional: Clean the URL to remove token query
                                    window.history.replaceState({}, document.title, "/");
                                    }

                                    // Get token (either just saved or from previous session)
                                    const loginToken = localStorage.getItem("loginToken");

                                    if (!loginToken) {
                                    // No token in URL or localStorage = not logged in
                                    window.location.href = "https://www.codency.uno/login"; // or show login UI
                                    return;
                                    }

                                    // Optional: decode token to get email/userId
                                    try {
                                    const loginToken = localStorage.getItem("loginToken");
                                    const payload = JSON.parse(atob(loginToken.split('.')[1]));
                                    const email = payload.email;
                                    const userId = payload.userId;
                                    localStorage.setItem("userEmail", email);
                                    localStorage.setItem("userId", userId);

                                    console.log("✅ Welcome", email);

                        // Fetch user data
                        try {
                            const response = await fetch('https://render-firebase-server.onrender.com/api/users/me', {
                                headers: {
                                    'Authorization': `Bearer ${loginToken}`,                                                
                                    'Content-Type': 'application/json'
                                    }
                                    });
                                        if (!response.ok) {
                                            throw new Error('Failed to fetch user data');
                                                            }
                                                                        
                                            const userData = await response.json();
                                            localStorage.setItem('email', userData.email);
                                            localStorage.setItem('balance', userData.balance);
                                            localStorage.setItem('createdAt', userData.createdAt);
                                            localStorage.setItem('lastLogin', userData.lastLogin);
                                            localStorage.setItem('tier', userData.tier);
                                            localStorage.setItem('currency', userData.currency);
                                            localStorage.setItem('identity', userData.identity);
                                            localStorage.setItem('iCount', userData.iCount);
                                            localStorage.setItem('tProfits', userData.tProfits);
                                            localStorage.setItem('pSold', userData.pSold);
                                            localStorage.setItem('userName', userData.userName);
                                            localStorage.setItem('country', userData.country);
                                            localStorage.setItem('inventory', JSON.stringify(userData.inventory));
                                            localStorage.setItem('kycStatus', userData.kycStatus);
                                            localStorage.setItem('notifyStatus', userData.notifyStatus);
                                            localStorage.setItem('notifications', JSON.stringify(userData.notifications));
                                            localStorage.setItem('history', JSON.stringify(userData.history));
                                            localStorage.setItem('referralCode', userData.referralCode);
                                            console.log('User data fetched successfully:', userData);
                                            } catch (error) {                                                
                                        console.error('Error fetching user data:', error);
                                        }
                                    } catch (e) {
                                    console.error("⛔ Invalid token format");
                                    localStorage.clear();
                                    localStorage.removeItem("loginToken");
                                    window.location.href = "https://www.codency.uno/login";                                    
                                }
                                })();
                                </script>


        </div>
    </body>
</html>